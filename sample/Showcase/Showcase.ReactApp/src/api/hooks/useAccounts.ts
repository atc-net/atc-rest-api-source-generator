// <auto-generated />
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useApiService } from './useApiService';
import { ApiError } from '../errors/ApiError';
import type { Account, Accounts, PaginatedResult } from '../models';

const accountsKeys = {
  all: ['accounts'] as const,
  list: (query?: { limit?: number }) => [...accountsKeys.all, 'list', query] as const,
  detail: (accountId: string) => [...accountsKeys.all, 'detail', accountId] as const,
  listPaginated: (query?: { pageSize?: number; pageIndex?: number; queryString?: string; continuation?: string }) => [...accountsKeys.all, 'listPaginated', query] as const,
};

export { accountsKeys };

export function useListAccounts(query?: { limit?: number }) {
  const api = useApiService();
  return useQuery({
    queryKey: accountsKeys.list(query),
    queryFn: async () => {
      const result = await api.accounts.listAccounts(query);
      if (result.status === 'ok' || result.status === 'created') {
        return result.data;
      }
      throw new ApiError(
        result.response.status,
        result.response.statusText,
        'error' in result ? result.error.message : 'Request failed',
        result.response,
      );
    },
  });
}

export function useCreateAccount() {
  const api = useApiService();
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (body: Account) => {
      const result = await api.accounts.createAccount(body);
      if (result.status === 'ok' || result.status === 'created') {
        return result.data;
      }
      throw new ApiError(
        result.response.status,
        result.response.statusText,
        'error' in result ? result.error.message : 'Request failed',
        result.response,
      );
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: accountsKeys.all });
    },
  });
}

export function useGetAccountById(accountId: string) {
  const api = useApiService();
  return useQuery({
    queryKey: accountsKeys.detail(accountId),
    queryFn: async () => {
      const result = await api.accounts.getAccountById(accountId);
      if (result.status === 'ok' || result.status === 'created') {
        return result.data;
      }
      throw new ApiError(
        result.response.status,
        result.response.statusText,
        'error' in result ? result.error.message : 'Request failed',
        result.response,
      );
    },
    enabled: !!accountId,
  });
}

export function useDeleteAccountById() {
  const api = useApiService();
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (accountId: string) => {
      const result = await api.accounts.deleteAccountById(accountId);
      if (result.status === 'noContent' || result.status === 'ok') {
        return;
      }
      throw new ApiError(
        result.response.status,
        result.response.statusText,
        'error' in result ? result.error.message : 'Request failed',
        result.response,
      );
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: accountsKeys.all });
    },
  });
}

export function useUpdateAccountById(accountId: string) {
  const api = useApiService();
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (body: Account) => {
      const result = await api.accounts.updateAccountById(accountId, body);
      if (result.status === 'ok' || result.status === 'created') {
        return result.data;
      }
      throw new ApiError(
        result.response.status,
        result.response.statusText,
        'error' in result ? result.error.message : 'Request failed',
        result.response,
      );
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: accountsKeys.all });
    },
  });
}

export function useListPaginatedAccounts(query?: { pageSize?: number; pageIndex?: number; queryString?: string; continuation?: string }) {
  const api = useApiService();
  return useQuery({
    queryKey: accountsKeys.listPaginated(query),
    queryFn: async () => {
      const result = await api.accounts.listPaginatedAccounts(query);
      if (result.status === 'ok' || result.status === 'created') {
        return result.data;
      }
      throw new ApiError(
        result.response.status,
        result.response.statusText,
        'error' in result ? result.error.message : 'Request failed',
        result.response,
      );
    },
  });
}

// Streaming operation listAsyncEnumerableAccounts is skipped.